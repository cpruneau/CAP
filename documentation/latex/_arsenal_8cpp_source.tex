\hypertarget{_arsenal_8cpp_source}{}\doxysection{Arsenal.\+cpp}
\label{_arsenal_8cpp_source}\index{HadronGas/Arsenal.cpp@{HadronGas/Arsenal.cpp}}
\mbox{\hyperlink{_arsenal_8cpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00001}00001 \textcolor{preprocessor}{\#include<iostream>}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00002}00002 \textcolor{preprocessor}{\#include<sstream>}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00003}00003 \textcolor{preprocessor}{\#include<fstream>}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00004}00004 \textcolor{preprocessor}{\#include<cmath>}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00005}00005 \textcolor{preprocessor}{\#include<iomanip>}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00006}00006 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_arsenal_8hpp}{Arsenal.hpp}}"{}}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00007}00007 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00008}\mbox{\hyperlink{_arsenal_8cpp_a91ed4760a30880350237bb614ae96972}{00008}} \textcolor{keywordtype}{void} \mbox{\hyperlink{_arsenal_8cpp_a91ed4760a30880350237bb614ae96972}{interpolation1D\_linear}}(\textcolor{keywordtype}{double}* Tb\_x, \textcolor{keywordtype}{double}* Tb\_y, \textcolor{keywordtype}{double}* xval, \textcolor{keywordtype}{double}* yval, \textcolor{keywordtype}{int} nTblength)}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00009}00009 \{}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00010}00010    \textcolor{keywordtype}{double} Xmin = Tb\_x[0];}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00011}00011    \textcolor{keywordtype}{double} Xmax = Tb\_x[nTblength-\/1];}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00012}00012    \textcolor{keywordtype}{double} dX = Tb\_x[1] -\/ Xmin;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00013}00013 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00014}00014    \textcolor{keywordtype}{double} x1, y1, y2;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00015}00015    \textcolor{keywordtype}{double} val\_x, result;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00016}00016    \textcolor{keywordtype}{int} idx;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00017}00017 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00018}00018    val\_x = *xval;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00019}00019    \textcolor{keywordflow}{if}(val\_x >= Xmax)}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00020}00020    \{}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00021}00021       idx = nTblength -\/ 2;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00022}00022    \}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00023}00023    \textcolor{keywordflow}{else} }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00024}00024    \{}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00025}00025       \textcolor{keywordflow}{if}(val\_x < Xmin) }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00026}00026          idx = 0;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00027}00027       \textcolor{keywordflow}{else} }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00028}00028          idx = (int)((val\_x -\/ Xmin)/dX);}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00029}00029    \}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00030}00030    x1 = Tb\_x[idx];}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00031}00031    y1 = Tb\_y[idx];}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00032}00032    y2 = Tb\_y[idx+1];}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00033}00033 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00034}00034    result = y1 + (y2 -\/ y1)*(val\_x -\/ x1)/dX;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00035}00035    *yval = result;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00036}00036    \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00037}00037 \}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00038}00038 \textcolor{comment}{/*}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00039}00039 \textcolor{comment}{double interpolation2D\_bilinear(Table2D* tb\_ptr, double varX, double varY, int Iwarning)}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00040}00040 \textcolor{comment}{\{}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00041}00041 \textcolor{comment}{     double varX\_min = tb\_ptr-\/>getVarXmin();}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00042}00042 \textcolor{comment}{     double varY\_min = tb\_ptr-\/>getVarYmin();}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00043}00043 \textcolor{comment}{     double dX = tb\_ptr-\/>getdvarX();}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00044}00044 \textcolor{comment}{     double dY = tb\_ptr-\/>getdvarY();}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00045}00045 \textcolor{comment}{     int tb\_sizeX = tb\_ptr-\/>getTbsizeX();}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00046}00046 \textcolor{comment}{     int tb\_sizeY = tb\_ptr-\/>getTbsizeY();}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00047}00047 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00048}00048 \textcolor{comment}{     int idx\_X = (int)floor((varX-\/varX\_min)/dX);}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00049}00049 \textcolor{comment}{     int idx\_Y = (int)floor((varY-\/varY\_min)/dY);}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00050}00050 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00051}00051 \textcolor{comment}{     //if it is out the table, doing linear extrapolation}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00052}00052 \textcolor{comment}{     if (idx\_X<0 || idx\_X>=tb\_sizeX-\/1)}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00053}00053 \textcolor{comment}{     \{}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00054}00054 \textcolor{comment}{        if(Iwarning == 1)}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00055}00055 \textcolor{comment}{        \{}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00056}00056 \textcolor{comment}{           cout<<"{}interpolation2D\_bilinear: varX out of bounds!"{}<<endl;}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00057}00057 \textcolor{comment}{           cout<<"{}varX= "{} << varX<<"{}idx\_X= "{}<<idx\_X<<endl;}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00058}00058 \textcolor{comment}{        \}}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00059}00059 \textcolor{comment}{        if(idx\_X < 0) idx\_X = 0;}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00060}00060 \textcolor{comment}{        if(idx\_X >= tb\_sizeX-\/1) idx\_X = tb\_sizeX -\/ 1;}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00061}00061 \textcolor{comment}{     \}}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00062}00062 \textcolor{comment}{     }}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00063}00063 \textcolor{comment}{     if (idx\_Y<0 || idx\_Y>=tb\_sizeY-\/1)}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00064}00064 \textcolor{comment}{     \{}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00065}00065 \textcolor{comment}{        if(Iwarning == 1)}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00066}00066 \textcolor{comment}{        \{}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00067}00067 \textcolor{comment}{           cout<<"{}interpolation2D\_bilinear: varY out of bounds!"{}<<endl;}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00068}00068 \textcolor{comment}{           cout<<"{}varY= "{} << varY<<"{}idx\_Y= "{}<<idx\_Y<<endl;}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00069}00069 \textcolor{comment}{        \}}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00070}00070 \textcolor{comment}{        if(idx\_Y < 0) idx\_Y = 0;}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00071}00071 \textcolor{comment}{        if(idx\_Y >= tb\_sizeY-\/1) idx\_Y = tb\_sizeY -\/ 2;}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00072}00072 \textcolor{comment}{     \}}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00073}00073 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00074}00074 \textcolor{comment}{     double f00 = tb\_ptr-\/>getTbdata(idx\_X, idx\_Y);}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00075}00075 \textcolor{comment}{     double f10 = tb\_ptr-\/>getTbdata(idx\_X+1, idx\_Y);}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00076}00076 \textcolor{comment}{     double f01 = tb\_ptr-\/>getTbdata(idx\_X, idx\_Y+1);}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00077}00077 \textcolor{comment}{     double f11 = tb\_ptr-\/>getTbdata(idx\_X+1, idx\_Y+1);}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00078}00078 \textcolor{comment}{     double ddx = varX -\/ (varX\_min + idx\_X*dX);}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00079}00079 \textcolor{comment}{     double ddy = varY -\/ (varY\_min + idx\_Y*dY);}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00080}00080 \textcolor{comment}{ }}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00081}00081 \textcolor{comment}{     double result;}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00082}00082 \textcolor{comment}{     result = (f00*(dX-\/ddx)*(dY-\/ddy) + f01*(dX-\/ddx)*ddy }}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00083}00083 \textcolor{comment}{              + f10*ddx*(dY-\/ddy) + f11*ddx*ddy)/dX/dY;}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00084}00084 \textcolor{comment}{     return(result);}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00085}00085 \textcolor{comment}{\}*/}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00086}00086 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00087}00087 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00088}\mbox{\hyperlink{_arsenal_8cpp_aefcc747cf91dd85ac917708586b5a600}{00088}} \textcolor{keywordtype}{double} \mbox{\hyperlink{_arsenal_8cpp_aefcc747cf91dd85ac917708586b5a600}{Simpson\_sum}}(\textcolor{keywordtype}{double}* array, \textcolor{keywordtype}{int} num, \textcolor{keywordtype}{double} h\_step)}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00089}00089 \{}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00090}00090       \textcolor{keywordtype}{double} sum=0;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00091}00091       \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} j=0;j<num-\/2;j+=2)}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00092}00092          sum += array[j]*1 + array[j+1]*4 + array[j+2]*1; }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00093}00093       sum = sum*h\_step/3.0;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00094}00094       \textcolor{keywordflow}{return}(sum);}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00095}00095 \}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00096}00096 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00097}00097 \textcolor{comment}{//**********************************************************************}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00098}\mbox{\hyperlink{_arsenal_8cpp_a2e0bbaf3df3956eb651d272a917651fb}{00098}} vector< vector<double>* >* \mbox{\hyperlink{_arsenal_8cpp_a2e0bbaf3df3956eb651d272a917651fb}{readBlockData}}(istream \&stream\_in)}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00099}00099 \textcolor{comment}{// Return a nested vector of vector<double>* object. Each column of data}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00100}00100 \textcolor{comment}{// is stored in a vector<double> array and the collection is the returned}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00101}00101 \textcolor{comment}{// object. Data are read from the input stream "{}stream\_in"{}. Each line}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00102}00102 \textcolor{comment}{// of data is processed by the stringToDoubles function. Note that the}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00103}00103 \textcolor{comment}{// data block is dynamically allocated and is not release within the}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00104}00104 \textcolor{comment}{// function.}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00105}00105 \textcolor{comment}{// Note that all "{}vectors"{} are "{}new"{} so don't forget to delete them.}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00106}00106 \textcolor{comment}{// Note also that the last line of data needs a return in order to be read.}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00107}00107 \{}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00108}00108   vector< vector<double>* >* data;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00109}00109   vector<double> valuesInEachLine;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00110}00110   \textcolor{keywordtype}{long} lineSize;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00111}00111   \textcolor{keywordtype}{long} i; \textcolor{comment}{// temp variable}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00112}00112   \textcolor{keywordtype}{char} buffer[99999]; \textcolor{comment}{// each line should be shorter than this}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00113}00113 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00114}00114   \textcolor{comment}{// first line:}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00115}00115   stream\_in.getline(buffer,99999);}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00116}00116   valuesInEachLine = \mbox{\hyperlink{_arsenal_8cpp_a83a32730f98fc4fe18862dc9eb6a55e4}{stringToDoubles}}(buffer);}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00117}00117   \textcolor{comment}{// see if it is empty:}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00118}00118   lineSize = valuesInEachLine.size();}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00119}00119   \textcolor{keywordflow}{if} (lineSize==0)}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00120}00120   \{}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00121}00121     \textcolor{comment}{// empty:}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00122}00122     cout << \textcolor{stringliteral}{"{}readBlockData warning: input stream has empty first row; no data read"{}} << endl;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00123}00123     \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00124}00124   \}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00125}00125   \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00126}00126   \{}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00127}00127     \textcolor{comment}{// not empty; allocate memory:}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00128}00128     data = \textcolor{keyword}{new} vector< vector<double>* >(lineSize);}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00129}00129     \textcolor{keywordflow}{for} (i=0; i<lineSize; i++) (*data)[i] = \textcolor{keyword}{new} vector<double>;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00130}00130   \}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00131}00131 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00132}00132   \textcolor{comment}{// rest of the lines:}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00133}00133   \textcolor{keywordflow}{while} (stream\_in.eof()==\textcolor{keyword}{false})}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00134}00134   \{}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00135}00135     \textcolor{comment}{// set values:}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00136}00136     \textcolor{keywordflow}{for} (i=0; i<lineSize; i++) (*(*data)[i]).push\_back(valuesInEachLine[i]);}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00137}00137     \textcolor{comment}{// next line:}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00138}00138     stream\_in.getline(buffer,99999);}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00139}00139     valuesInEachLine = \mbox{\hyperlink{_arsenal_8cpp_a83a32730f98fc4fe18862dc9eb6a55e4}{stringToDoubles}}(buffer);}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00140}00140   \}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00141}00141 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00142}00142   \textcolor{keywordflow}{return} data;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00143}00143 \}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00144}00144 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00145}00145 \textcolor{comment}{//**********************************************************************}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00146}\mbox{\hyperlink{_arsenal_8cpp_abc1c2466fa5454ce18bd91572d79a483}{00146}} \textcolor{keywordtype}{void} \mbox{\hyperlink{_arsenal_8cpp_abc1c2466fa5454ce18bd91572d79a483}{releaseBlockData}}(vector< vector<double>* >* data)}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00147}00147 \textcolor{comment}{// Use to delete the data block allocated by readBlockData function.}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00148}00148 \{}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00149}00149   \textcolor{keywordflow}{if} (data)}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00150}00150   \{}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00151}00151     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} i=0; i<data-\/>size(); i++) \textcolor{keyword}{delete} (*data)[i];}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00152}00152     \textcolor{keyword}{delete} data;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00153}00153   \}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00154}00154 \}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00155}00155 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00156}00156 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00157}00157 \textcolor{comment}{//**********************************************************************}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00158}\mbox{\hyperlink{_arsenal_8cpp_a83a32730f98fc4fe18862dc9eb6a55e4}{00158}} vector<double> \mbox{\hyperlink{_arsenal_8cpp_a83a32730f98fc4fe18862dc9eb6a55e4}{stringToDoubles}}(\textcolor{keywordtype}{string} str)}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00159}00159 \textcolor{comment}{// Return a vector of doubles from the string "{}str"{}. "{}str"{} should}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00160}00160 \textcolor{comment}{// be a string containing a line of data.}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00161}00161 \{}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00162}00162   stringstream sst(str+\textcolor{stringliteral}{"{} "{}}); \textcolor{comment}{// add a blank at the end so the last data will be read}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00163}00163   vector<double> valueList;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00164}00164   \textcolor{keywordtype}{double} val;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00165}00165   sst >> val;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00166}00166   \textcolor{keywordflow}{while} (sst.eof()==\textcolor{keyword}{false})}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00167}00167   \{}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00168}00168     valueList.push\_back(val);}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00169}00169     sst >> val;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00170}00170   \}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00171}00171   \textcolor{keywordflow}{return} valueList;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00172}00172 \}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00173}00173 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00174}00174 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00175}00175 \textcolor{comment}{//**********************************************************************}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00176}\mbox{\hyperlink{_arsenal_8cpp_afec8b9fd79a6c3dc81e24e41a60dacb8}{00176}} \textcolor{keywordtype}{double} \mbox{\hyperlink{_arsenal_8cpp_afec8b9fd79a6c3dc81e24e41a60dacb8}{interpCubicDirect}}(vector<double>* x, vector<double>* y, \textcolor{keywordtype}{double} x0)}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00177}00177 \textcolor{comment}{// Returns the interpreted value of y=y(x) at x=x0 using cubic polynomial interpolation method.}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00178}00178 \textcolor{comment}{// -\/-\/ x,y: the independent and dependent double x0ables; x is assumed to be equal spaced and increasing}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00179}00179 \textcolor{comment}{// -\/-\/ x0: where the interpolation should be performed}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00180}00180 \{}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00181}00181   \textcolor{keywordtype}{long} size = x-\/>size();}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00182}00182   \textcolor{keywordflow}{if} (size==1) \{cout<<\textcolor{stringliteral}{"{}interpCubicDirect warning: table size = 1"{}}; \textcolor{keywordflow}{return} (*y)[0];\}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00183}00183   \textcolor{keywordtype}{double} dx = (*x)[1]-\/(*x)[0]; \textcolor{comment}{// increment in x}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00184}00184 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00185}00185   \textcolor{comment}{// if close to left end:}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00186}00186   \textcolor{keywordflow}{if} (abs(x0-\/(*x)[0])<dx*1e-\/30) \textcolor{keywordflow}{return} (*y)[0];}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00187}00187 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00188}00188   \textcolor{comment}{// find x's integer index}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00189}00189   \textcolor{keywordtype}{long} idx = floor((x0-\/(*x)[0])/dx);}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00190}00190 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00191}00191   \textcolor{keywordflow}{if} (idx<0 || idx>=size-\/1)}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00192}00192   \{}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00193}00193     cout    << \textcolor{stringliteral}{"{}interpCubicDirect: x0 out of bounds."{}} << endl}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00194}00194             << \textcolor{stringliteral}{"{}x ranges from "{}} << (*x)[0] << \textcolor{stringliteral}{"{} to "{}} << (*x)[size-\/1] << \textcolor{stringliteral}{"{}, "{}}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00195}00195             << \textcolor{stringliteral}{"{}x0="{}} << x0 << \textcolor{stringliteral}{"{}, "{}} << \textcolor{stringliteral}{"{}dx="{}} << dx << \textcolor{stringliteral}{"{}, "{}} << \textcolor{stringliteral}{"{}idx="{}} << idx << endl;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00196}00196     exit(1);}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00197}00197   \}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00198}00198 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00199}00199   \textcolor{keywordflow}{if} (idx==0)}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00200}00200   \{}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00201}00201     \textcolor{comment}{// use quadratic interpolation at left end}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00202}00202     \textcolor{keywordtype}{double} A0 = (*y)[0], A1 = (*y)[1], A2 = (*y)[2], deltaX = x0 -\/ (*x)[0]; \textcolor{comment}{// deltaX is the increment of x0 compared to the closest lattice point}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00203}00203     \textcolor{keywordflow}{return} (A0-\/2.0*A1+A2)/(2.0*dx*dx)*deltaX*deltaX -\/ (3.0*A0-\/4.0*A1+A2)/(2.0*dx)*deltaX + A0;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00204}00204   \}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00205}00205   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (idx==size-\/2)}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00206}00206   \{}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00207}00207     \textcolor{comment}{// use quadratic interpolation at right end}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00208}00208     \textcolor{keywordtype}{double} A0 = (*y)[size-\/3], A1 = (*y)[size-\/2], A2 = (*y)[size-\/1], deltaX = x0 -\/ ((*x)[0] + (idx-\/1)*dx);}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00209}00209     \textcolor{keywordflow}{return} (A0-\/2.0*A1+A2)/(2.0*dx*dx)*deltaX*deltaX -\/ (3.0*A0-\/4.0*A1+A2)/(2.0*dx)*deltaX + A0;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00210}00210   \}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00211}00211   \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00212}00212   \{}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00213}00213     \textcolor{comment}{// use cubic interpolation}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00214}00214     \textcolor{keywordtype}{double} A0 = (*y)[idx-\/1], A1 = (*y)[idx], A2 = (*y)[idx+1], A3 = (*y)[idx+2], deltaX = x0 -\/ ((*x)[0] + idx*dx);}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00215}00215     \textcolor{comment}{//cout << A0 << "{}  "{} << A1 << "{}  "{} << A2 << "{}  "{} << A3 << endl;}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00216}00216     \textcolor{keywordflow}{return} (-\/A0+3.0*A1-\/3.0*A2+A3)/(6.0*dx*dx*dx)*deltaX*deltaX*deltaX}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00217}00217             + (A0-\/2.0*A1+A2)/(2.0*dx*dx)*deltaX*deltaX}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00218}00218             -\/ (2.0*A0+3.0*A1-\/6.0*A2+A3)/(6.0*dx)*deltaX}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00219}00219             + A1;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00220}00220   \}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00221}00221 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00222}00222 \}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00223}00223 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00224}00224 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00225}00225 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00226}00226 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00227}00227 \textcolor{comment}{//**********************************************************************}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00228}\mbox{\hyperlink{_arsenal_8cpp_ac742fdbc8f506ac2197ef44122737762}{00228}} \textcolor{keywordtype}{double} \mbox{\hyperlink{_arsenal_8cpp_ac742fdbc8f506ac2197ef44122737762}{interpLinearDirect}}(vector<double>* x, vector<double>* y, \textcolor{keywordtype}{double} x0)}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00229}00229 \textcolor{comment}{// Returns the interpreted value of y=y(x) at x=x0 using linear interpolation method.}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00230}00230 \textcolor{comment}{// -\/-\/ x,y: the independent and dependent double x0ables; x is assumed to be equal spaced and increasing}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00231}00231 \textcolor{comment}{// -\/-\/ x0: where the interpolation should be performed}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00232}00232 \{}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00233}00233   \textcolor{keywordtype}{long} size = x-\/>size();}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00234}00234   \textcolor{keywordflow}{if} (size==1) \{cout<<\textcolor{stringliteral}{"{}interpLinearDirect warning: table size = 1"{}}<<endl; \textcolor{keywordflow}{return} (*y)[0];\}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00235}00235   \textcolor{keywordtype}{double} dx = (*x)[1]-\/(*x)[0]; \textcolor{comment}{// increment in x}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00236}00236 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00237}00237   \textcolor{comment}{// if close to left end:}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00238}00238   \textcolor{keywordflow}{if} (abs(x0-\/(*x)[0])<dx*1e-\/30) \textcolor{keywordflow}{return} (*y)[0];}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00239}00239 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00240}00240   \textcolor{comment}{// find x's integer index}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00241}00241   \textcolor{keywordtype}{long} idx = floor((x0-\/(*x)[0])/dx);}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00242}00242 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00243}00243   \textcolor{keywordflow}{if} (idx<0 || idx>=size-\/1)}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00244}00244   \{}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00245}00245     cout    << \textcolor{stringliteral}{"{}interpLinearDirect: x0 out of bounds."{}} << endl}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00246}00246             << \textcolor{stringliteral}{"{}x ranges from "{}} << (*x)[0] << \textcolor{stringliteral}{"{} to "{}} << (*x)[size-\/1] << \textcolor{stringliteral}{"{}, "{}}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00247}00247             << \textcolor{stringliteral}{"{}x0="{}} << x0 << \textcolor{stringliteral}{"{}, "{}} << \textcolor{stringliteral}{"{}dx="{}} << dx << \textcolor{stringliteral}{"{}, "{}} << \textcolor{stringliteral}{"{}idx="{}} << idx << endl;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00248}00248     exit(1);}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00249}00249   \}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00250}00250 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00251}00251   \textcolor{keywordflow}{return} (*y)[idx] + ((*y)[idx+1]-\/(*y)[idx])/dx*(x0-\/(*x)[idx]);}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00252}00252 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00253}00253 \}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00254}00254 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00255}00255 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00256}00256 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00257}00257 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00258}00258 \textcolor{comment}{//**********************************************************************}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00259}\mbox{\hyperlink{_arsenal_8cpp_a9e098c13a5a50e37667a0622b1aa0fe1}{00259}} \textcolor{keywordtype}{double} \mbox{\hyperlink{_arsenal_8cpp_a9e098c13a5a50e37667a0622b1aa0fe1}{interpNearestDirect}}(vector<double>* x, vector<double>* y, \textcolor{keywordtype}{double} x0)}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00260}00260 \textcolor{comment}{// Returns the interpreted value of y=y(x) at x=x0 using nearest interpolation method.}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00261}00261 \textcolor{comment}{// -\/-\/ x,y: the independent and dependent double x0ables; x is assumed to be equal spaced and increasing}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00262}00262 \textcolor{comment}{// -\/-\/ x0: where the interpolation should be performed}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00263}00263 \{}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00264}00264   \textcolor{keywordtype}{long} size = x-\/>size();}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00265}00265   \textcolor{keywordflow}{if} (size==1) \{cout<<\textcolor{stringliteral}{"{}interpNearestDirect warning: table size = 1"{}}<<endl; \textcolor{keywordflow}{return} (*y)[0];\}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00266}00266   \textcolor{keywordtype}{double} dx = (*x)[1]-\/(*x)[0]; \textcolor{comment}{// increment in x}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00267}00267 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00268}00268   \textcolor{comment}{// if close to left end:}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00269}00269   \textcolor{keywordflow}{if} (abs(x0-\/(*x)[0])<dx*1e-\/30) \textcolor{keywordflow}{return} (*y)[0];}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00270}00270 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00271}00271   \textcolor{comment}{// find x's integer index}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00272}00272   \textcolor{keywordtype}{long} idx = floor((x0-\/(*x)[0])/dx);}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00273}00273 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00274}00274   \textcolor{keywordflow}{if} (idx<0 || idx>=size-\/1)}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00275}00275   \{}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00276}00276     cout    << \textcolor{stringliteral}{"{}interpNearestDirect: x0 out of bounds."{}} << endl}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00277}00277             << \textcolor{stringliteral}{"{}x ranges from "{}} << (*x)[0] << \textcolor{stringliteral}{"{} to "{}} << (*x)[size-\/1] << \textcolor{stringliteral}{"{}, "{}}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00278}00278             << \textcolor{stringliteral}{"{}x0="{}} << x0 << \textcolor{stringliteral}{"{}, "{}} << \textcolor{stringliteral}{"{}dx="{}} << dx << \textcolor{stringliteral}{"{}, "{}} << \textcolor{stringliteral}{"{}idx="{}} << idx << endl;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00279}00279     exit(1);}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00280}00280   \}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00281}00281 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00282}00282   \textcolor{keywordflow}{return} x0-\/(*x)[idx]>dx/2 ? (*y)[idx+1] : (*y)[idx];}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00283}00283 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00284}00284 \}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00285}00285 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00286}00286 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00287}00287 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00288}00288 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00289}00289 \textcolor{comment}{//**********************************************************************}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00290}\mbox{\hyperlink{_arsenal_8cpp_ac64e117a561d87893774f28278302a66}{00290}} \textcolor{keywordtype}{double} \mbox{\hyperlink{_arsenal_8cpp_ac64e117a561d87893774f28278302a66}{interpCubicMono}}(vector<double>* x, vector<double>* y, \textcolor{keywordtype}{double} xx)}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00291}00291 \textcolor{comment}{// Returns the interpreted value of y=y(x) at x=x0 using cubic polynomial interpolation method.}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00292}00292 \textcolor{comment}{// -\/-\/ x,y: the independent and dependent double x0ables; x is *NOT* assumed to be equal spaced but it has to be increasing}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00293}00293 \textcolor{comment}{// -\/-\/ xx: where the interpolation should be performed}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00294}00294 \{}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00295}00295   \textcolor{keywordtype}{long} size = x-\/>size();}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00296}00296   \textcolor{keywordflow}{if} (size==1) \{cout<<\textcolor{stringliteral}{"{}interpCubicMono warning: table size = 1"{}}<<endl; \textcolor{keywordflow}{return} (*y)[0];\}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00297}00297 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00298}00298   \textcolor{comment}{// if close to left end:}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00299}00299   \textcolor{keywordflow}{if} (abs(xx-\/(*x)[0])<((*x)[1]-\/(*x)[0])*1e-\/30) \textcolor{keywordflow}{return} (*y)[0];}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00300}00300 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00301}00301   \textcolor{comment}{// find x's integer index}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00302}00302   \textcolor{keywordtype}{long} idx = \mbox{\hyperlink{_arsenal_8cpp_a5919c604f227faff91734a91c77944c9}{binarySearch}}(x, xx);}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00303}00303 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00304}00304   \textcolor{keywordflow}{if} (idx<0 || idx>=size-\/1)}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00305}00305   \{}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00306}00306     cout    << \textcolor{stringliteral}{"{}interpCubicMono: x0 out of bounds."{}} << endl}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00307}00307             << \textcolor{stringliteral}{"{}x ranges from "{}} << (*x)[0] << \textcolor{stringliteral}{"{} to "{}} << (*x)[size-\/1] << \textcolor{stringliteral}{"{}, "{}}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00308}00308             << \textcolor{stringliteral}{"{}xx="{}} << xx << \textcolor{stringliteral}{"{}, "{}} << \textcolor{stringliteral}{"{}idx="{}} << idx << endl;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00309}00309     exit(1);}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00310}00310   \}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00311}00311 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00312}00312   \textcolor{keywordflow}{if} (idx==0)}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00313}00313   \{}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00314}00314     \textcolor{comment}{// use linear interpolation at the left end}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00315}00315     \textcolor{keywordflow}{return} (*y)[0] + ( (*y)[1]-\/(*y)[0] )/( (*x)[1]-\/(*x)[0] )*( xx-\/(*x)[0] );}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00316}00316   \}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00317}00317   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (idx==size-\/2)}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00318}00318   \{}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00319}00319     \textcolor{comment}{// use linear interpolation at the right end}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00320}00320     \textcolor{keywordflow}{return} (*y)[size-\/2] + ( (*y)[size-\/1]-\/(*y)[size-\/2] )/( (*x)[size-\/1]-\/(*x)[size-\/2] )*( xx-\/(*x)[size-\/2] );}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00321}00321   \}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00322}00322   \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00323}00323   \{}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00324}00324     \textcolor{comment}{// use cubic interpolation}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00325}00325     \textcolor{keywordtype}{long} \textcolor{keywordtype}{double} y0 = (*y)[idx-\/1], y1 = (*y)[idx], y2 = (*y)[idx+1], y3 = (*y)[idx+2];}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00326}00326     \textcolor{keywordtype}{long} \textcolor{keywordtype}{double} y01=y0-\/y1, y02=y0-\/y2, y03=y0-\/y3, y12=y1-\/y2, y13=y1-\/y3, y23=y2-\/y3;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00327}00327     \textcolor{keywordtype}{long} \textcolor{keywordtype}{double} x0 = (*x)[idx-\/1], x1 = (*x)[idx], x2 = (*x)[idx+1], x3 = (*x)[idx+2];}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00328}00328     \textcolor{keywordtype}{long} \textcolor{keywordtype}{double} x01=x0-\/x1, x02=x0-\/x2, x03=x0-\/x3, x12=x1-\/x2, x13=x1-\/x3, x23=x2-\/x3;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00329}00329     \textcolor{keywordtype}{long} \textcolor{keywordtype}{double} x0s=x0*x0, x1s=x1*x1, x2s=x2*x2, x3s=x3*x3;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00330}00330     \textcolor{keywordtype}{long} \textcolor{keywordtype}{double} denominator = x01*x02*x12*x03*x13*x23;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00331}00331     \textcolor{keywordtype}{long} \textcolor{keywordtype}{double} C0, C1, C2, C3;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00332}00332     C0 = (x0*x02*x2*x03*x23*x3*y1}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00333}00333           + x1*x1s*(x0*x03*x3*y2+x2s*(-\/x3*y0+x0*y3)+x2*(x3s*y0-\/x0s*y3))}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00334}00334           + x1*(x0s*x03*x3s*y2+x2*x2s*(-\/x3s*y0+x0s*y3)+x2s*(x3*x3s*y0-\/x0*x0s*y3))}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00335}00335           + x1s*(x0*x3*(-\/x0s+x3s)*y2+x2*x2s*(x3*y0-\/x0*y3)+x2*(-\/x3*x3s*y0+x0*x0s*y3))}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00336}00336           )/denominator;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00337}00337     C1 = (x0s*x03*x3s*y12}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00338}00338           + x2*x2s*(x3s*y01+x0s*y13)}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00339}00339           + x1s*(x3*x3s*y02+x0*x0s*y23-\/x2*x2s*y03)}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00340}00340           + x2s*(-\/x3*x3s*y01-\/x0*x0s*y13)}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00341}00341           + x1*x1s*(-\/x3s*y02+x2s*y03-\/x0s*y23)}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00342}00342           )/denominator;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00343}00343     C2 = (-\/x0*x3*(x0s-\/x3s)*y12}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00344}00344           + x2*(x3*x3s*y01+x0*x0s*y13)}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00345}00345           + x1*x1s*(x3*y02+x0*y23-\/x2*y03)}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00346}00346           + x2*x2s*(-\/x3*y01-\/x0*y13)}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00347}00347           + x1*(-\/x3*x3s*y02+x2*x2s*y03-\/x0*x0s*y23)}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00348}00348           )/denominator;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00349}00349     C3 = (x0*x03*x3*y12}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00350}00350           + x2s*(x3*y01+x0*y13)}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00351}00351           + x1*(x3s*y02+x0s*y23-\/x2s*y03)}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00352}00352           + x2*(-\/x3s*y01-\/x0s*y13)}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00353}00353           + x1s*(-\/x3*y02+x2*y03-\/x0*y23)}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00354}00354           )/denominator;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00355}00355 \textcolor{comment}{/*    cout  << x0s*x03*x3s*y12 << "{}  "{}}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00356}00356 \textcolor{comment}{          <<  x2*x2s*(x3s*y01+x0s*y13) << "{}   "{}}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00357}00357 \textcolor{comment}{          <<  x1s*(x3*x3s*y02+x0*x0s*y23-\/x2*x2s*y03) << "{}  "{}}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00358}00358 \textcolor{comment}{          <<  x2s*(-\/x3*x3s*y01-\/x0*x0s*y13) << "{}  "{}}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00359}00359 \textcolor{comment}{          <<  x1*x1s*(-\/x3s*y02+x2s*y03-\/x0s*y23) << endl;}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00360}00360 \textcolor{comment}{    cout << denominator << endl;}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00361}00361 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00362}00362 \textcolor{comment}{    cout << x0 << "{} "{} << x1 << "{}  "{} << x2 << "{}  "{} << x3 << endl;}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00363}00363 \textcolor{comment}{    cout << y0 << "{} "{} << y1 << "{}  "{} << y2 << "{}  "{} << y3 << endl;}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00364}00364 \textcolor{comment}{    cout << C0 << "{}  "{} << C1 << "{}  "{} << C2 << "{}  "{} << C3 << endl;*/}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00365}00365     \textcolor{keywordflow}{return} C0 + C1*xx + C2*xx*xx + C3*xx*xx*xx;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00366}00366   \}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00367}00367 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00368}00368 \}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00369}00369 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00370}00370 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00371}00371 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00372}00372 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00373}00373 \textcolor{comment}{//**********************************************************************}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00374}\mbox{\hyperlink{_arsenal_8cpp_a5f7ab461cd6988522c6a067992f638cd}{00374}} \textcolor{keywordtype}{double} \mbox{\hyperlink{_arsenal_8cpp_a5f7ab461cd6988522c6a067992f638cd}{interpLinearMono}}(vector<double>* x, vector<double>* y, \textcolor{keywordtype}{double} xx)}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00375}00375 \textcolor{comment}{// Returns the interpreted value of y=y(x) at x=x0 using linear interpolation method.}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00376}00376 \textcolor{comment}{// -\/-\/ x,y: the independent and dependent double x0ables; x is *NOT* assumed to be equal spaced but it has to be increasing}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00377}00377 \textcolor{comment}{// -\/-\/ xx: where the interpolation should be performed}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00378}00378 \{}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00379}00379   \textcolor{keywordtype}{long} size = x-\/>size();}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00380}00380   \textcolor{keywordflow}{if} (size==1) \{cout<<\textcolor{stringliteral}{"{}interpLinearMono warning: table size = 1"{}}<<endl; \textcolor{keywordflow}{return} (*y)[0];\}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00381}00381 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00382}00382   \textcolor{comment}{// if close to left end:}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00383}00383   \textcolor{keywordflow}{if} (abs(xx-\/(*x)[0])<((*x)[1]-\/(*x)[0])*1e-\/30) \textcolor{keywordflow}{return} (*y)[0];}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00384}00384 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00385}00385   \textcolor{comment}{// find x's integer index}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00386}00386   \textcolor{keywordtype}{long} idx = \mbox{\hyperlink{_arsenal_8cpp_a5919c604f227faff91734a91c77944c9}{binarySearch}}(x, xx);}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00387}00387 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00388}00388   \textcolor{keywordflow}{if} (idx<0 || idx>=size-\/1)}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00389}00389   \{}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00390}00390     cout    << \textcolor{stringliteral}{"{}interpLinearMono: x0 out of bounds."{}} << endl}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00391}00391             << \textcolor{stringliteral}{"{}x ranges from "{}} << (*x)[0] << \textcolor{stringliteral}{"{} to "{}} << (*x)[size-\/1] << \textcolor{stringliteral}{"{}, "{}}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00392}00392             << \textcolor{stringliteral}{"{}xx="{}} << xx << \textcolor{stringliteral}{"{}, "{}} << \textcolor{stringliteral}{"{}idx="{}} << idx << endl;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00393}00393     exit(1);}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00394}00394   \}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00395}00395 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00396}00396   \textcolor{keywordflow}{return} (*y)[idx] + ( (*y)[idx+1]-\/(*y)[idx] )/( (*x)[idx+1]-\/(*x)[idx] )*( xx-\/(*x)[idx] );}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00397}00397 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00398}00398 \}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00399}00399 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00400}00400 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00401}00401 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00402}00402 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00403}00403 \textcolor{comment}{//**********************************************************************}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00404}\mbox{\hyperlink{_arsenal_8cpp_a8dd5902a8770150e2d59b1644371607d}{00404}} \textcolor{keywordtype}{double} \mbox{\hyperlink{_arsenal_8cpp_a8dd5902a8770150e2d59b1644371607d}{interpNearestMono}}(vector<double>* x, vector<double>* y, \textcolor{keywordtype}{double} xx)}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00405}00405 \textcolor{comment}{// Returns the interpreted value of y=y(x) at x=x0 using nearest interpolation method.}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00406}00406 \textcolor{comment}{// -\/-\/ x,y: the independent and dependent double x0ables; x is *NOT* assumed to be equal spaced but it has to be increasing}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00407}00407 \textcolor{comment}{// -\/-\/ xx: where the interpolation should be performed}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00408}00408 \{}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00409}00409   \textcolor{keywordtype}{long} size = x-\/>size();}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00410}00410   \textcolor{keywordflow}{if} (size==1) \{cout<<\textcolor{stringliteral}{"{}interpNearestMono warning: table size = 1"{}}<<endl; \textcolor{keywordflow}{return} (*y)[0];\}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00411}00411 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00412}00412   \textcolor{comment}{// if close to left end:}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00413}00413   \textcolor{keywordflow}{if} (abs(xx-\/(*x)[0])<((*x)[1]-\/(*x)[0])*1e-\/30) \textcolor{keywordflow}{return} (*y)[0];}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00414}00414 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00415}00415   \textcolor{comment}{// find x's integer index}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00416}00416   \textcolor{keywordtype}{long} idx = \mbox{\hyperlink{_arsenal_8cpp_a5919c604f227faff91734a91c77944c9}{binarySearch}}(x, xx);}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00417}00417 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00418}00418   \textcolor{keywordflow}{if} (idx<0 || idx>=size-\/1)}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00419}00419   \{}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00420}00420     cout    << \textcolor{stringliteral}{"{}interpNearestMono: x0 out of bounds."{}} << endl}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00421}00421             << \textcolor{stringliteral}{"{}x ranges from "{}} << (*x)[0] << \textcolor{stringliteral}{"{} to "{}} << (*x)[size-\/1] << \textcolor{stringliteral}{"{}, "{}}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00422}00422             << \textcolor{stringliteral}{"{}xx="{}} << xx << \textcolor{stringliteral}{"{}, "{}} << \textcolor{stringliteral}{"{}idx="{}} << idx << endl;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00423}00423     exit(1);}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00424}00424   \}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00425}00425 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00426}00426   \textcolor{keywordflow}{return} xx-\/(*x)[idx] > (*x)[idx+1]-\/xx ? (*y)[idx+1] : (*y)[idx];}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00427}00427 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00428}00428 \}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00429}00429 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00430}00430 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00431}00431 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00432}00432 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00433}00433 \textcolor{comment}{//**********************************************************************}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00434}\mbox{\hyperlink{_arsenal_8cpp_a6044315dd9981784140318ee6c6cdc51}{00434}} \textcolor{keywordtype}{double} \mbox{\hyperlink{_arsenal_8cpp_a6044315dd9981784140318ee6c6cdc51}{invertFunc}}(\textcolor{keywordtype}{double} (*func)(\textcolor{keywordtype}{double}), \textcolor{keywordtype}{double} y, \textcolor{keywordtype}{double} xL, \textcolor{keywordtype}{double} xR, \textcolor{keywordtype}{double} dx, \textcolor{keywordtype}{double} x0, \textcolor{keywordtype}{double} relative\_accuracy)}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00435}00435 \textcolor{comment}{//Purpose:}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00436}00436 \textcolor{comment}{//  Return x=func\string^(-\/1)(y) using Newton method.}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00437}00437 \textcolor{comment}{//  -\/-\/ func: double 1-\/argument function to be inverted}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00438}00438 \textcolor{comment}{//  -\/-\/ xL: left boundary (for numeric derivative)}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00439}00439 \textcolor{comment}{//  -\/-\/ xR: right boundary (for numeric derivative)}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00440}00440 \textcolor{comment}{//  -\/-\/ dx: step (for numeric derivative)}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00441}00441 \textcolor{comment}{//  -\/-\/ x0: initial value}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00442}00442 \textcolor{comment}{//  -\/-\/ y: the value to be inverted}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00443}00443 \textcolor{comment}{//  -\/-\/ Returns inverted value}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00444}00444 \textcolor{comment}{//Solve: f(x)=0 with f(x)=table(x)-\/y => f'(x)=table'(x)}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00445}00445 \{}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00446}00446   \textcolor{keywordtype}{double} accuracy;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00447}00447   \textcolor{keywordtype}{int} tolerance;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00448}00448 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00449}00449   \textcolor{keywordtype}{double} XX1, XX2; \textcolor{comment}{// used in iterations}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00450}00450   \textcolor{keywordtype}{double} F0, F1, F2, F3, X1, X2; \textcolor{comment}{// intermedia variables}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00451}00451   \textcolor{keywordtype}{int} impatience; \textcolor{comment}{// number of iterations}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00452}00452 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00453}00453 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00454}00454   \textcolor{comment}{// initialize parameters}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00455}00455   accuracy = dx*relative\_accuracy;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00456}00456 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00457}00457   tolerance = 60;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00458}00458   impatience = 0;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00459}00459 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00460}00460   \textcolor{comment}{// initial value, left point and midxle point}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00461}00461   XX2 = x0;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00462}00462   XX1 = XX2-\/10*accuracy; \textcolor{comment}{// this value 10*accuracy is meanless, just to make sure the check in the while statement goes through}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00463}00463 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00464}00464   \textcolor{keywordflow}{while} (abs(XX2-\/XX1)>accuracy)}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00465}00465   \{}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00466}00466     XX1 = XX2; \textcolor{comment}{// copy values}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00467}00467 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00468}00468     \textcolor{comment}{// value of function at XX}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00469}00469     F0 = (*func)(XX1) -\/ y; \textcolor{comment}{// the value of the function at this point}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00470}00470 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00471}00471     \textcolor{comment}{// decide X1 and X2 for differentiation}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00472}00472     \textcolor{keywordflow}{if} (XX1>xL+dx)}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00473}00473       X1 = XX1 -\/ dx;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00474}00474     \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00475}00475       X1 = xL;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00476}00476 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00477}00477     \textcolor{keywordflow}{if} (XX1<xR-\/dx)}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00478}00478       X2 = XX1 + dx;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00479}00479     \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00480}00480       X2 = xR;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00481}00481 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00482}00482     \textcolor{comment}{// get values at X1 and X2}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00483}00483     F1 = (*func)(X1);}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00484}00484     F2 = (*func)(X2);}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00485}00485     F3 = (F1-\/F2)/(X1-\/X2); \textcolor{comment}{// derivative at XX1}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00486}00486 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00487}00487     XX2 = XX1 -\/ F0/F3; \textcolor{comment}{// Newton's mysterious method}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00488}00488 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00489}00489     impatience = impatience + 1;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00490}00490     \textcolor{comment}{//cout << "{}impatience="{} << impatience << endl;}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00491}00491     \textcolor{keywordflow}{if} (impatience>tolerance)}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00492}00492     \{}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00493}00493       cout << \textcolor{stringliteral}{"{}invertFunc: "{}} << \textcolor{stringliteral}{"{}max number of iterations reached."{}} << endl;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00494}00494       exit(-\/1);}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00495}00495     \}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00496}00496 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00497}00497   \} \textcolor{comment}{// <=> abs(XX2-\/XX1)>accuracy}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00498}00498 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00499}00499   \textcolor{keywordflow}{return} XX2;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00500}00500 \}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00501}00501 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00502}00502 \textcolor{comment}{//**********************************************************************}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00503}\mbox{\hyperlink{_arsenal_8cpp_aa41a7cabe73aaf4ec0057be2f2dce1b7}{00503}} vector<double> *\mbox{\hyperlink{_arsenal_8cpp_aa41a7cabe73aaf4ec0057be2f2dce1b7}{zq\_x\_global}}, *\mbox{\hyperlink{_arsenal_8cpp_afe8dd86a36e09ac520ba8f19d01727c1}{zq\_y\_global}};}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00504}\mbox{\hyperlink{_arsenal_8cpp_a27e11a9e791091ff4b5cb929b3c3158e}{00504}} \textcolor{keywordtype}{double} \mbox{\hyperlink{_arsenal_8cpp_a27e11a9e791091ff4b5cb929b3c3158e}{invertTableDirect\_hook}}(\textcolor{keywordtype}{double} xx) \{\textcolor{keywordflow}{return} \mbox{\hyperlink{_arsenal_8cpp_afec8b9fd79a6c3dc81e24e41a60dacb8}{interpCubicDirect}}(\mbox{\hyperlink{_arsenal_8cpp_aa41a7cabe73aaf4ec0057be2f2dce1b7}{zq\_x\_global}},\mbox{\hyperlink{_arsenal_8cpp_afe8dd86a36e09ac520ba8f19d01727c1}{zq\_y\_global}},xx);\}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00505}\mbox{\hyperlink{_arsenal_8cpp_a6533016c5d3392c23c90706db9c4cc0f}{00505}} \textcolor{keywordtype}{double} \mbox{\hyperlink{_arsenal_8cpp_a6533016c5d3392c23c90706db9c4cc0f}{invertTableDirect}}(vector<double>* x, vector<double>* y, \textcolor{keywordtype}{double} y0, \textcolor{keywordtype}{double} x0, \textcolor{keywordtype}{double} relative\_accuracy)}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00506}00506 \textcolor{comment}{// Return x0=y\string^(-\/1)(y0) for y=y(x); use interpCubic and invertFunc.}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00507}00507 \textcolor{comment}{//  -\/-\/ x,y: the independent and dependent variables. x is assumed to be equal-\/spaced.}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00508}00508 \textcolor{comment}{//  -\/-\/ y0: where the inversion should be performed.}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00509}00509 \textcolor{comment}{//  -\/-\/ x0: initial guess}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00510}00510 \{}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00511}00511   \textcolor{keywordtype}{long} size = x-\/>size();}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00512}00512   \textcolor{keywordflow}{if} (size==1) \textcolor{keywordflow}{return} (*y)[0];}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00513}00513   \mbox{\hyperlink{_arsenal_8cpp_aa41a7cabe73aaf4ec0057be2f2dce1b7}{zq\_x\_global}} = x; \mbox{\hyperlink{_arsenal_8cpp_afe8dd86a36e09ac520ba8f19d01727c1}{zq\_y\_global}} = y;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00514}00514   \textcolor{keywordflow}{return} \mbox{\hyperlink{_arsenal_8cpp_a6044315dd9981784140318ee6c6cdc51}{invertFunc}}(\&\mbox{\hyperlink{_arsenal_8cpp_a27e11a9e791091ff4b5cb929b3c3158e}{invertTableDirect\_hook}}, y0, (*x)[0], (*x)[size-\/1], (*x)[1]-\/(*x)[0], x0, relative\_accuracy);}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00515}00515 \}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00516}00516 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00517}00517 \textcolor{comment}{//**********************************************************************}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00518}\mbox{\hyperlink{_arsenal_8cpp_a5919c604f227faff91734a91c77944c9}{00518}} \textcolor{keywordtype}{long} \mbox{\hyperlink{_arsenal_8cpp_a5919c604f227faff91734a91c77944c9}{binarySearch}}(vector<double>* A, \textcolor{keywordtype}{double} value)}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00519}00519 \textcolor{comment}{// Return the index of the largest number less than value in the list A}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00520}00520 \textcolor{comment}{// using binary search.}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00521}00521 \{}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00522}00522    \textcolor{keywordtype}{int} length = A-\/>size();}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00523}00523    \textcolor{keywordtype}{int} idx\_i, idx\_f, idx;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00524}00524    idx\_i = 0;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00525}00525    idx\_f = length-\/1;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00526}00526    \textcolor{keywordflow}{if}(value > (*A)[idx\_f])}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00527}00527    \{}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00528}00528       cout << \textcolor{stringliteral}{"{}binarySearch: desired value is too large,  exceed the end of the table."{}} << endl;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00529}00529       exit(1);}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00530}00530    \}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00531}00531    \textcolor{keywordflow}{if}(value < (*A)[idx\_i])}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00532}00532    \{}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00533}00533       cout << \textcolor{stringliteral}{"{}binarySearch: desired value is too small, exceed the begin of table."{}} << endl;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00534}00534       exit(1);}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00535}00535    \}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00536}00536    idx = (int) floor((idx\_f+idx\_i)/2.);}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00537}00537    \textcolor{keywordflow}{while}((idx\_f-\/idx\_i) > 1)}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00538}00538    \{}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00539}00539      \textcolor{keywordflow}{if}((*A)[idx] < value)}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00540}00540         idx\_i = idx;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00541}00541      \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00542}00542         idx\_f = idx;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00543}00543      idx = (int) floor((idx\_f+idx\_i)/2.);}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00544}00544    \}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00545}00545    \textcolor{keywordflow}{return}(idx\_i);}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00546}00546 \}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00547}00547 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00548}\mbox{\hyperlink{_arsenal_8cpp_ad506d089e68f1a775ba2e2865d22b500}{00548}} \textcolor{keywordtype}{void} \mbox{\hyperlink{_arsenal_8cpp_ad506d089e68f1a775ba2e2865d22b500}{outputFunctionerror}}(\textcolor{keywordtype}{string} function\_name, \textcolor{keywordtype}{string} massage, \textcolor{keywordtype}{double} value, \textcolor{keywordtype}{int} level)}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00549}00549 \{}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00550}00550    \textcolor{keywordflow}{switch}(level)}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00551}00551    \{}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00552}00552       \textcolor{keywordflow}{case} 0:}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00553}00553          \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00554}00554       \textcolor{keywordflow}{case} 1:}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00555}00555          cout << \textcolor{stringliteral}{"{}>>> Warning: "{}} << function\_name << endl; }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00556}00556          cout << \textcolor{stringliteral}{"{}>>> Message: "{}} << massage << endl;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00557}00557          cout << \textcolor{stringliteral}{"{}>>> Related value: "{}} << value << endl;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00558}00558          \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00559}00559       \textcolor{keywordflow}{case} 2:}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00560}00560          cout << \textcolor{stringliteral}{"{}>>> Error: "{}} << function\_name << endl; }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00561}00561          cout << \textcolor{stringliteral}{"{}>>> Message: "{}} << massage << endl;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00562}00562          cout << \textcolor{stringliteral}{"{}>>> Related value: "{}} << value << endl;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00563}00563          \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00564}00564       \textcolor{keywordflow}{case} 3:}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00565}00565          cout << \textcolor{stringliteral}{"{}>>> Fatal Error: "{}} << function\_name << endl; }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00566}00566          cout << \textcolor{stringliteral}{"{}>>> Message: "{}} << massage << endl;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00567}00567          cout << \textcolor{stringliteral}{"{}>>> Related value: "{}} << value << endl;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00568}00568          exit(1);}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00569}00569          \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00570}00570       \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00571}00571          cout << \textcolor{stringliteral}{"{}>>> Error: outputFunctionerror:"{}} << endl;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00572}00572          cout << \textcolor{stringliteral}{"{}>>> Message: wrong errorLevel"{}} << endl;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00573}00573          cout << \textcolor{stringliteral}{"{}>>> Related value: "{}} << level << endl;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00574}00574          exit(1);}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00575}00575          \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00576}00576    \}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00577}00577 \}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00578}00578 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00579}00579 \textcolor{comment}{//**********************************************************************}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00580}\mbox{\hyperlink{_arsenal_8cpp_a637fd73afd1fadd689749ce8ec66e33a}{00580}} \textcolor{keywordtype}{string} \mbox{\hyperlink{_arsenal_8cpp_a637fd73afd1fadd689749ce8ec66e33a}{toLower}}(\textcolor{keywordtype}{string} str)}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00581}00581 \textcolor{comment}{// Convert all character in string to lower case}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00582}00582 \{}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00583}00583   \textcolor{keywordtype}{string} tmp = str;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00584}00584   \textcolor{keywordflow}{for} (string::iterator it=tmp.begin(); it<=tmp.end(); it++) *it = tolower(*it);}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00585}00585   \textcolor{keywordflow}{return} tmp;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00586}00586 \}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00587}00587 \textcolor{comment}{//**********************************************************************}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00588}\mbox{\hyperlink{_arsenal_8cpp_aa7cb820696f8a66d03330e091482020c}{00588}} \textcolor{keywordtype}{string} \mbox{\hyperlink{_arsenal_8cpp_aa7cb820696f8a66d03330e091482020c}{trim}}(\textcolor{keywordtype}{string} str)}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00589}00589 \textcolor{comment}{// Convert all character in string to lower case}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00590}00590 \{}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00591}00591   \textcolor{keywordtype}{string} tmp = str;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00592}00592   \textcolor{keywordtype}{long} number\_of\_char = 0;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00593}00593   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} ii=0; ii<str.size(); ii++)}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00594}00594     \textcolor{keywordflow}{if} (str[ii]!=\textcolor{charliteral}{' '} \&\& str[ii]!=\textcolor{charliteral}{'\(\backslash\)t'})}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00595}00595     \{}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00596}00596       tmp[number\_of\_char]=str[ii];}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00597}00597       number\_of\_char++;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00598}00598     \}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00599}00599   tmp.resize(number\_of\_char);}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00600}00600   \textcolor{keywordflow}{return} tmp;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00601}00601 \}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00602}00602 }
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00603}00603 \textcolor{comment}{//**********************************************************************}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00604}\mbox{\hyperlink{_arsenal_8cpp_a7e564ec0266d67f518a0b0f80f17e203}{00604}} \textcolor{keywordtype}{double} \mbox{\hyperlink{_arsenal_8cpp_a7e564ec0266d67f518a0b0f80f17e203}{stringToDouble}}(\textcolor{keywordtype}{string} str)}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00605}00605 \textcolor{comment}{// Return the 1st doubles number read from the string "{}str"{}. "{}str"{} should be a string containing a line of data.}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00606}00606 \{}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00607}00607   stringstream sst(str+\textcolor{stringliteral}{"{} "{}}); \textcolor{comment}{// add a blank at the end so the last data will be read}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00608}00608   \textcolor{keywordtype}{double} val;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00609}00609   sst >> val;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00610}00610   \textcolor{keywordflow}{return} val;}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00611}00611 \}}
\DoxyCodeLine{\Hypertarget{_arsenal_8cpp_source_l00612}00612 }

\end{DoxyCode}
